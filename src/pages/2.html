<html>
    <head>
        <title>Demo page</title>
        <link
            rel="shortcut icon"
            href="data:image/x-icon;,"
            type="image/x-icon"
        />
        <!-- <script src="http://localhost:8001/"></script> -->
        <!-- Snippet usage example -->
        <script>
          (e=>{let t={headers:{"Content-Type":"text/plain"},apiUrl:"http://localhost:8001",dTMs:1e3},
          l=[],n=null,r=null,a=(e,l)=>l?e.getTime()-l.getTime():t.dTMs,s=(t,l)=>({event:t,tags:l,url:e.location.href,
          title:document.getElementsByTagName("title")[0].innerHTML,ts:new Date().toISOString()}),i=e=>{l.push(e)},
          d=()=>{l=[]},h=()=>{if(!l.length)return;let e=[...l];d(),n=new Date,fetch(`${t.apiUrl}/track`,
          {headers:t.headers,method:"POST",body:JSON.stringify({events:e})}).catch(()=>{let t=[...l];l=[...e,...t]})};
          class o{track(e,...d){r&&(clearTimeout(r),r=null);let o=s(e,d);i(o);let T=a(new Date,n);if(l.length>=3){h();
          return}n&&T>=t.dTMs?h():r=setTimeout(()=>{h()},t.dTMs-T)}}e.addEventListener("beforeunload",e=>{e.preventDefault(),h()}),
          e.tracker=new o})(window);
      </script>
        <script>
            tracker.track('pageview')
            tracker.track('test', 'one', 'two', 'three')
        </script>
    </head>
    <body>
        <button onclick="tracker.track('click-button')">Click me</button>
        <ul>
            <li>
                <a href="/" onclick="tracker.track('click-link', 'root')"
                    >Root</a
                >
            </li>
            <li>
                <a href="/1.html" onclick="tracker.track('click-link', '1')"
                    >1.html</a
                >
            </li>
            <li>
                <a href="/2.html" onclick="tracker.track('click-link', '2')"
                    >2.html</a
                >
            </li>
        </ul>
    </body>
</html>
