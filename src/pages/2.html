<html>
    <head>
        <title>Demo page</title>
        <link
            rel="shortcut icon"
            href="data:image/x-icon;,"
            type="image/x-icon"
        />
        <!-- <script src="http://localhost:8001/"></script> -->
        <!-- Snippet usage example -->
        <script>
        (e=>{let t={headers:{"Content-Type":"text/plain"},apiUrl:"http://localhost:8001",dTms:1e3},n=[],
        l=null,a=null, r=(e,n)=>n?e.getTime()-n.getTime():t.dTms,i=(t,n)=>({event:t,tags:n,url:e.location.href,
        title:document.getElementsByTagName("title")[0].innerHTML,ts:new Date().toISOString()}),s=e=>{n.push(e)},
        o=()=>{n=[]},d=()=>{if(!n.length)return;let e=[...n];o(),l=new Date,fetch(`${t.apiUrl}/track`,
        {headers:t.headers,method:"POST",body:JSON.stringify({events:e})}).catch(t=>{console.log(t.status);
        let l=[...n];n=[...e,...l]})},g=()=>{let e=r(new Date,l),i=l&&e>=t.dTms;if(n.length>=3||i){d();return}
        a=setTimeout(()=>{d()},t.dTms-e)};class h{track(e,...t){a&&(clearTimeout(a),a=null);let n=i(e,t);s(n),g()}}
        e.navigator.connection.onchange=()=>{e.navigator.onLine&&g()},e.addEventListener("beforeunload",e=>{e.preventDefault(),d()}),
        e.tracker=new h})(window);
      </script>
        <script>
            tracker.track('pageview')
            tracker.track('test', 'one', 'two', 'three')
        </script>
    </head>
    <body>
        <button onclick="tracker.track('click-button')">Click me</button>
        <ul>
            <li>
                <a href="/" onclick="tracker.track('click-link', 'root')"
                    >Root</a
                >
            </li>
            <li>
                <a href="/1.html" onclick="tracker.track('click-link', '1')"
                    >1.html</a
                >
            </li>
            <li>
                <a href="/2.html" onclick="tracker.track('click-link', '2')"
                    >2.html</a
                >
            </li>
        </ul>
    </body>
</html>
